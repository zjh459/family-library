<!--pages/index/index.wxml-->
<view class="container">
  <view class="header">
    <view class="header-title">我的家庭图书馆</view>
    <van-search
      value="{{ searchValue }}"
      placeholder="搜索书名或作者"
      bind:change="onSearchChange"
      bind:search="onSearch"
      shape="round"
      background="transparent"
    />
  </view>
  
  <!-- 分类 -->
  <view class="section">
    <view class="section-header">
      <view class="section-title">按分类浏览</view>
    </view>
    <view class="category-list">
      <view 
        class="category-item {{selectedCategory === 'all' ? 'active' : ''}}" 
        bindtap="selectCategory" 
        data-category="all"
        style="{{selectedCategory !== 'all' ? 'background-color:' + theme.highlightColor : 'background-color:' + theme.accentColor}}"
      >
        全部
      </view>
      <view 
        class="category-item {{selectedCategory === category.name ? 'active' : ''}}" 
        wx:for="{{categories}}" 
        wx:key="_id" 
        wx:for-item="category"
        bindtap="selectCategory" 
        data-category="{{category.name}}"
        style="{{selectedCategory !== category.name ? 'background-color:' + theme.highlightColor : 'background-color:' + theme.accentColor}}"
      >
        {{category.name}}
      </view>
    </view>
    
    <!-- 图书列表 -->
    <view class="book-grid">
      <block wx:if="{{filteredBooks.length > 0}}">
        <view class="book-item" wx:for="{{filteredBooks}}" wx:key="_id" bindtap="goToDetail" data-id="{{item._id}}">
          <image class="book-cover" src="{{item.coverUrl || '../../images/default-cover.png'}}" mode="aspectFill"></image>
          <view class="book-title">{{item.title}}</view>
        </view>
      </block>
      <view wx:else class="empty-tip">暂无图书，点击右下角"+"添加</view>
    </view>
  </view>

  <!-- 添加按钮 -->
  <view class="add-button" bindtap="goToAdd">+</view>
</view> 